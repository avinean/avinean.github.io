SAP_STORE.checkoutV2Cart=function(k,b,m){function l(a,d,c,f){a=b("regions"+c+"-"+d).find("option:checked").val()||null;var g=b("hosting"+c+"-"+d).find("option:checked").val()||null;if(""===f)b("#dataCenterSelect-"+c+"-"+d).addClass("dataCenterInvalid");else{b("#dataCenterSelect-"+c+"-"+d).removeClass("dataCenterInvalid");var h=b("#cartNextStepButton");h.attr("disabled","disabled");jQuery.ajax({type:"POST",url:"/checkout/v2/update-data-center",data:{productCode:d,entryNumber:c,dataCenter:f,region:a,
hostingProvider:g},success:function(b){h.removeAttr("disabled");checkoutErrorHide();p(b)},error:function(b){checkoutError(b.responseJSON)}})}}function p(a){checkoutService.cartSection.updateCartFromData(a);checkoutCommon.showPromotionMessages(a.cartData);checkoutCommon.showPromotionChosenMessage(a.showPromotionChosenMessage);a={data:a.cartData,onReleaseVoucher:checkoutService.cartSection.releaseVoucher.bind(checkoutService.cartSection),$checkoutAppliedVouchers:b("#checkoutAppliedVouchers"),$checkoutDynamicVoucher:b("#checkoutDynamicVoucher"),
$cartVoucher:b("#cartVoucher")};checkoutCommon.hideVoucher(a)}function n(a){b("#cartNextStepButton").length&&(a?b("#cartNextStepButton").addClass("disabled"):b("#cartNextStepButton").removeClass("disabled"))}function q(a){a?(b(".durationSelect").attr("disabled","disabled"),b('input[name\x3d"subscriptionStartDate"]').attr("disabled","disabled")):(b(".durationSelect").removeAttr("disabled"),b('input[name\x3d"subscriptionStartDate"]').removeAttr("disabled"))}return{increaseQuantity:function(a){a=a.data("ufid");
a=b("input#qtyCart-"+a);var d=parseInt(a.val()),c=parseInt(a.prop("max"));if(d<c||!c)d++,a.attr("value",d).change(),a.valid()},decreaseQuantity:function(a){a=a.data("ufid");a=b("input#qtyCart-"+a);var d=parseInt(a.val()),c=parseInt(a.prop("min"));if(d>c||!c)d--,a.attr("value",d).change(),a.valid()},toggleQuantityIncDecButtons:function(a,d,c,f,g){a===d||1===a?(b("#quantity-decrease-"+f).prop("disabled","true"),clearInterval(g)):b("#quantity-decrease-"+f).prop("disabled","");a===c&&-1<c?(b("#quantity-increase-"+
f).prop("disabled","true"),clearInterval(g)):b("#quantity-increase-"+f).prop("disabled","")},updateQuantityCart:function(a){var d=b("#updateCartFormV2"+a),c=d.find('input[name\x3d"quantity"]'),f=d.find('select[name\x3d"quantity"]');a=d.find('input[name\x3d"quantityHiddenCheck"]');var g;0<c.length?g=c.val():0<f.length&&(g=f.val());c=a.val();g!==c&&!b.isEmptyObject(g)&&0<g&&(a.val(g),n(!0),jQuery.ajax({type:"POST",url:"/checkout/v2/update-product-quantity",data:d.serialize(),success:function(a){checkoutErrorHide();
checkoutService.cartSection.updateCartFromData(a);trackingOmnitureUpdateCart(a.adobeInformation);!0===k.gtmEnabled&&trackUpdateCart_GTM(a.adobeInformation.productId,a.adobeInformation.quantity,a.adobeInformation.quantity,a.adobeInformation.productId,a.adobeInformation.productRevenue);checkoutCommon.showPromotionMessages(a.cartData);checkoutCommon.showPromotionChosenMessage(a.showPromotionChosenMessage);var c={data:a.cartData,onReleaseVoucher:checkoutService.cartSection.releaseVoucher.bind(checkoutService.cartSection),
$checkoutAppliedVouchers:b("#checkoutAppliedVouchers"),$checkoutDynamicVoucher:b("#checkoutDynamicVoucher"),$cartVoucher:b("#cartVoucher")};checkoutCommon.hideVoucher(c);var c=a.cartData.entries[0],e=b("#originalSubscriptionQuantityText");"upgrade"===c.upgradeType&&c.quantity>a.licenseCount&&c.isPaidToPaid&&""!==a.messageLicenseCount?e.stop("true").text(a.messageLicenseCount).show():e.stop("true").addClass("hide");n(!d.valid());q(!1)},error:function(b){n(!0);q(!0);checkoutError(b.responseJSON)}}))},
updateDateCart:function(a){var d=a.data("ufid"),c=b("#updateCartFormV2"+d),f=a.data("entry"),g=a.data("change-duration");a=b("#subscriptionStartDate"+d);var h=b(c).find("span.durationHardcode");h.length||(h=b("#durationSelect-"+f));var r=b(c).find("span.subscriptionEndDateHardcode");jQuery.ajax({type:"POST",url:"/checkout/v2/update-date",data:{entryNumber:f,subscriptionStartDate:a.val()},success:function(a){var c=a.cartData.entries[f],d=c.subscriptionFormattedEndDate;checkoutErrorHide();g||(c=c.subscriptionDuration+
" "+c.subscriptionDurationUnit,b(h).text(c));b(r).text(d);p(a)},error:function(a){checkoutError(a.responseJSON)}})},updateDurationPrices:function(a,d){var c=a.data("ufid"),c=b("#updateCartFormV2"+c),f=a.data("entry-number"),g=b(c).find("span.subscriptionEndDateHardcode");jQuery.ajax({type:"POST",url:"/checkout/v2/update-duration",dataType:"json",async:!1,data:b(c).serialize(),success:function(a){var c=a.cartData,e=c.entries[f],l=e.totalPrice.formattedValue,k=e.subscriptionFormattedEndDate;b(".v2SubtotalPriceValue  \x3e strong").html(l);
checkoutService.cartSection.updateCartFromData(a);checkoutCommon.showPromotionMessages(a.cartData);checkoutCommon.showPromotionChosenMessage(a.showPromotionChosenMessage);b(g).text(k);l={data:c,onReleaseVoucher:checkoutService.cartSection.releaseVoucher.bind(checkoutService.cartSection),$checkoutAppliedVouchers:b("#checkoutAppliedVouchers"),$checkoutDynamicVoucher:b("#checkoutDynamicVoucher"),$cartVoucher:b("#cartVoucher")};checkoutCommon.hideVoucher(l);d||updateAvailableBillingPeriods(e);null!==
e.totalPricePerBillingPeriod&&"0.0"!=e.totalPricePerBillingPeriod.value?(b("[name\x3dbillingPeriod]").data("is-asm-session")?e.billingPeriod.defaultDuration?checkoutInfoHide():checkoutInfoMessage(a.infoTopMessage):b(".js-billing-interval-config-"+e.product.code).removeClass("hide"),b(".js-billing-interval-"+e.product.code).removeClass("hide"),null!=e.product.productReferences[0]&&toggleCloudBillingPeriod(e.product.productReferences[0].target.code,c.entries),a=b("#checkoutV2TotalLabel"),e=b(".checkoutTotal .tooltip-icon"),
e.removeClass("hide"),a.removeClass("strongPriceData"),a.addClass("small-11").addClass("column").addClass("total-billing-amount"),b("#totalPrice").removeClass("has-not-billing-duration"),b("#checkoutV2TotalValue strong").css("fontWeight","normal"),b(document).foundation(),0<c.totalTax.value||null!=c.totalTaxPerBillingPeriod&&0<c.totalTaxPerBillingPeriod.value||(e.addClass("hide"),a.removeClass("small-11").removeClass("column"))):(b("[name\x3dbillingPeriod]").data("is-asm-session")?checkoutInfoHide():
b(".js-billing-interval-config-"+e.product.code).addClass("hide"),b(".js-billing-interval-"+e.product.code).addClass("hide"),null!=e.product.productReferences[0]&&toggleCloudBillingPeriod(e.product.productReferences[0].target.code,c.entries),b("#checkoutV2TotalLabel").addClass("strongPriceData"),b("#checkoutV2TotalLabel").removeClass("small-11").removeClass("column").removeClass("total-billing-amount"),b(".checkoutTotal .tooltip-icon").addClass("hide"),b("#totalPrice").addClass("has-not-billing-duration"),
b("#checkoutV2TotalValue strong").css("fontWeight","bold"),0<c.totalTax.value||null!=c.totalTaxPerBillingPeriod&&0<c.totalTaxPerBillingPeriod.value||(b(".checkoutTotal .tooltip-icon").addClass("hide"),b("#checkoutV2TotalLabel").removeClass("small-11").removeClass("column")));c.hasCustomBillingPeriod?b("#customBillingPeriodTotal").removeClass("hide"):b("#customBillingPeriodTotal").addClass("hide")}})},dataCenterChange:function(a){var d=a.val(),c=a.data("ufid"),f=a.data("productcode"),g=a.data("entry"),
h=b("#updateCartFormV2"+c);b("input[id][name\x3d'dataCenter']").val(d);h.validate().element(a);l(c,f,g,d)},updateHardwareKey:function(a){a=a||{};return jQuery.ajax({type:"POST",url:a.url,data:a.data})},clearCouponCodeErr:function(){b("#cartVouchers #cartVoucher .voucherFieldReveal").is(":visible")&&!b.trim(b('#cartVouchers input[name\x3d"voucherCode"]').val())&&(b("#cartVouchers .voucherCodeLabel").removeClass("form-error bold"),checkoutErrorHide("#voucherFormError"),b("#cartVouchers #cartVoucher .voucherFieldReveal").toggle())}}}(window,
jQuery,SAP_STORE);function toggleCloudBillingPeriod(k,b){var m=!1;b.forEach(function(b){b.product.code==k&&b.isSAPCloudSupplementaryProduct&&null!==b.totalPricePerBillingPeriod&&"0.0"!=b.totalPricePerBillingPeriod.value&&(m=!0)});m?$(".js-billing-interval-"+k).removeClass("hide"):$(".js-billing-interval-"+k).addClass("hide")};
